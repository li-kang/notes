<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Npm与Yarn包管理技术 | 技术学派</title>
    <meta name="description" content="Web前端技术、干货、教程、课程笔记">
    <link rel="icon" href="/favicon.ico">
  <meta name="robots" content="all">
  <meta name="author" content="likang">
  <meta name="keywords" content="Web全栈知识体系, web体系, web知识体系, web框架, web详解, web学习路线, web spring, web面试, 知识体系, web技术体系, web编程, web编程指南,web开发体系, web开发,web教程,web,web数据结构, 算法, 开发基础">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <script src="https://hm.baidu.com/hm.js?a2fd998a0322a08f10309f035d7009e1"></script>
    
    <link rel="preload" href="/assets/css/0.styles.c9eb7bf0.css" as="style"><link rel="preload" href="/assets/js/app.36f33a9d.js" as="script"><link rel="preload" href="/assets/js/2.d27f56d2.js" as="script"><link rel="preload" href="/assets/js/23.cd435639.js" as="script"><link rel="prefetch" href="/assets/js/10.d1e6c66a.js"><link rel="prefetch" href="/assets/js/11.29746d89.js"><link rel="prefetch" href="/assets/js/12.0605b152.js"><link rel="prefetch" href="/assets/js/13.3b6be312.js"><link rel="prefetch" href="/assets/js/14.e0cf0d42.js"><link rel="prefetch" href="/assets/js/15.86f20d18.js"><link rel="prefetch" href="/assets/js/16.a660308b.js"><link rel="prefetch" href="/assets/js/17.2c6ab243.js"><link rel="prefetch" href="/assets/js/18.e8ce1763.js"><link rel="prefetch" href="/assets/js/19.34c3af53.js"><link rel="prefetch" href="/assets/js/20.3fa7618a.js"><link rel="prefetch" href="/assets/js/21.4c157aad.js"><link rel="prefetch" href="/assets/js/22.47eb5636.js"><link rel="prefetch" href="/assets/js/24.990a63e1.js"><link rel="prefetch" href="/assets/js/25.47122bec.js"><link rel="prefetch" href="/assets/js/26.05b4f7ae.js"><link rel="prefetch" href="/assets/js/27.9ab1d9bc.js"><link rel="prefetch" href="/assets/js/28.50943c3b.js"><link rel="prefetch" href="/assets/js/29.bd08d43b.js"><link rel="prefetch" href="/assets/js/3.2c8e19c4.js"><link rel="prefetch" href="/assets/js/30.cd670f1e.js"><link rel="prefetch" href="/assets/js/31.fc962975.js"><link rel="prefetch" href="/assets/js/32.16de1a8c.js"><link rel="prefetch" href="/assets/js/33.5331101e.js"><link rel="prefetch" href="/assets/js/34.1df38d3f.js"><link rel="prefetch" href="/assets/js/35.2e0c63f6.js"><link rel="prefetch" href="/assets/js/4.e3d63e9c.js"><link rel="prefetch" href="/assets/js/5.0fc728f0.js"><link rel="prefetch" href="/assets/js/6.596668dc.js"><link rel="prefetch" href="/assets/js/7.5a102747.js"><link rel="prefetch" href="/assets/js/8.53b312d6.js"><link rel="prefetch" href="/assets/js/9.0ec4f429.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c9eb7bf0.css">   
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">技术学派</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/notes/" class="nav-link router-link-active">主线课程大纲</a></div><div class="nav-item"><a href="/techs.html" class="nav-link">技术栈</a></div><div class="nav-item"><a href="/nav.html" class="nav-link">网站导航</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端编码规范" class="dropdown-title"><span class="title">前端编码规范</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/rules/html.html" class="nav-link">HTML 编码规范</a></li><li class="dropdown-item"><!----> <a href="/rules/css.html" class="nav-link">CSS 编码规范</a></li><li class="dropdown-item"><!----> <a href="/rules/js.html" class="nav-link">JavaScript 编码规范</a></li><li class="dropdown-item"><!----> <a href="/specification.html" class="nav-link">文档编写规范</a></li></ul></div></div><div class="nav-item"><a href="/tips.html" class="nav-link">学习建议</a></div><div class="nav-item"><a href="/discuss.html" class="nav-link">留言</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/notes/" class="nav-link router-link-active">主线课程大纲</a></div><div class="nav-item"><a href="/techs.html" class="nav-link">技术栈</a></div><div class="nav-item"><a href="/nav.html" class="nav-link">网站导航</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端编码规范" class="dropdown-title"><span class="title">前端编码规范</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/rules/html.html" class="nav-link">HTML 编码规范</a></li><li class="dropdown-item"><!----> <a href="/rules/css.html" class="nav-link">CSS 编码规范</a></li><li class="dropdown-item"><!----> <a href="/rules/js.html" class="nav-link">JavaScript 编码规范</a></li><li class="dropdown-item"><!----> <a href="/specification.html" class="nav-link">文档编写规范</a></li></ul></div></div><div class="nav-item"><a href="/tips.html" class="nav-link">学习建议</a></div><div class="nav-item"><a href="/discuss.html" class="nav-link">留言</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Npm与Yarn包管理技术</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/Npm%E4%B8%8EYarn%E5%8C%85%E7%AE%A1%E7%90%86%E6%8A%80%E6%9C%AF/#第一章-npm入门" class="sidebar-link">第一章 npm入门</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/Npm%E4%B8%8EYarn%E5%8C%85%E7%AE%A1%E7%90%86%E6%8A%80%E6%9C%AF/#第一节-简介" class="sidebar-link">第一节 简介</a></li><li class="sidebar-sub-header"><a href="/notes/Npm%E4%B8%8EYarn%E5%8C%85%E7%AE%A1%E7%90%86%E6%8A%80%E6%9C%AF/#第二节-npm常用命令" class="sidebar-link">第二节 npm常用命令</a></li><li class="sidebar-sub-header"><a href="/notes/Npm%E4%B8%8EYarn%E5%8C%85%E7%AE%A1%E7%90%86%E6%8A%80%E6%9C%AF/#第三节-package-json" class="sidebar-link">第三节 package.json</a></li></ul></li><li><a href="/notes/Npm%E4%B8%8EYarn%E5%8C%85%E7%AE%A1%E7%90%86%E6%8A%80%E6%9C%AF/#第二章-package-json主要字段" class="sidebar-link">第二章 package.json主要字段</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/Npm%E4%B8%8EYarn%E5%8C%85%E7%AE%A1%E7%90%86%E6%8A%80%E6%9C%AF/#第一节-scripts字段" class="sidebar-link">第一节 scripts字段</a></li><li class="sidebar-sub-header"><a href="/notes/Npm%E4%B8%8EYarn%E5%8C%85%E7%AE%A1%E7%90%86%E6%8A%80%E6%9C%AF/#第二节-dependencies与devdependencies字段" class="sidebar-link">第二节 dependencies与devDependencies字段</a></li></ul></li><li><a href="/notes/Npm%E4%B8%8EYarn%E5%8C%85%E7%AE%A1%E7%90%86%E6%8A%80%E6%9C%AF/#第三章-发布-npm-包" class="sidebar-link">第三章 发布 npm 包</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/Npm%E4%B8%8EYarn%E5%8C%85%E7%AE%A1%E7%90%86%E6%8A%80%E6%9C%AF/#第一节-发布前的准备" class="sidebar-link">第一节 发布前的准备</a></li><li class="sidebar-sub-header"><a href="/notes/Npm%E4%B8%8EYarn%E5%8C%85%E7%AE%A1%E7%90%86%E6%8A%80%E6%9C%AF/#第二节-登录" class="sidebar-link">第二节 登录</a></li><li class="sidebar-sub-header"><a href="/notes/Npm%E4%B8%8EYarn%E5%8C%85%E7%AE%A1%E7%90%86%E6%8A%80%E6%9C%AF/#第三节-发布" class="sidebar-link">第三节 发布</a></li></ul></li><li><a href="/notes/Npm%E4%B8%8EYarn%E5%8C%85%E7%AE%A1%E7%90%86%E6%8A%80%E6%9C%AF/#附录：" class="sidebar-link">附录：</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/Npm%E4%B8%8EYarn%E5%8C%85%E7%AE%A1%E7%90%86%E6%8A%80%E6%9C%AF/#bin子目录" class="sidebar-link">.bin子目录</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="npm与yarn包管理技术"><a href="#npm与yarn包管理技术" class="header-anchor">#</a> Npm与Yarn包管理技术</h1> <h2 id="第一章-npm入门"><a href="#第一章-npm入门" class="header-anchor">#</a> 第一章 npm入门</h2> <h3 id="第一节-简介"><a href="#第一节-简介" class="header-anchor">#</a> 第一节 简介</h3> <p>Nodejs自身提供了基本的模块，但是开发实际应用过程中仅仅依靠这些基本模块是远远不够的，那么如何获得其他模块文件？我开发的模块又如何分享给其他人使用呢？另外，即便拥有了这些模块，又该如何管理呢？</p> <p><a href="https://www.npmjs.com/" target="_blank" rel="noopener noreferrer">npm<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>（Node Package Manager）是随同NodeJS一起安装的。node根据<a href="http://www.commonjs.org/" target="_blank" rel="noopener noreferrer">common JS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>规范实现了包机制，并开发了npm来解决包的发布和获取需求，是NodeJS包管理和分发工具。</p> <p>有了npm，可以很快的找到要使用的包，进行下载、安装以及管理已经安装的包。npm能解决NodeJS代码部署上的很多问题，常见的使用场景有：</p> <ul><li>从npm服务器下载第三方包到本地使用。</li> <li>从npm服务器下载并安装第三方的命令行程序到本地使用。</li> <li>将自己编写的包或命令行程序上传到npm服务器供别人使用。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//查看npm版本</span>
$ npm <span class="token operator">-</span>v
<span class="token number">2.3</span><span class="token number">.0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>npm是一个独立软件（随同node一起安装），可以使用如下命令更新版本：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install npm -g
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>由于npm官网服务器在境外，国内访问速度很慢，可以尝试使用淘宝在国内制作了一个<a href="https://npm.taobao.org/" target="_blank" rel="noopener noreferrer">淘宝npm镜像<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>服务器，命令如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm config set registry https://registry.npm.taobao.org
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查看当前镜像地址：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm get registry
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>淘宝镜像与npm官网的文件不能做到100%同步，还是建议首选npm官网。取消淘宝镜像（设置为npm官网）：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm config set registry https://registry.npmjs.org
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>另外，还可以安装淘宝镜像<strong>cnpm</strong>，使用 <code>cnpm install xxx</code> 的方式安装模块（cnpm 安装的模块路径比较奇怪，不推荐使用）:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install -g cnpm -registry=https://registry.npm.taobao.org
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></blockquote> <h3 id="第二节-npm常用命令"><a href="#第二节-npm常用命令" class="header-anchor">#</a> 第二节 npm常用命令</h3> <table><thead><tr><th>命令</th> <th>说明</th></tr></thead> <tbody><tr><td>npm init</td> <td>初始化 package.json</td></tr> <tr><td>npm install</td> <td>安装模块</td></tr> <tr><td>npm update</td> <td>升级模块到最新版本</td></tr> <tr><td>npm run</td> <td>运行package.json中 <code>scripts</code> 字段的命令</td></tr> <tr><td>npm uninstall</td> <td>卸载包</td></tr></tbody></table> <h3 id="第三节-package-json"><a href="#第三节-package-json" class="header-anchor">#</a> 第三节 package.json</h3> <p>每个项目的根目录下面，都有一个package.json文件，记录了这个项目所需要的各种模块，以及项目的配置信息（比如名称、版本、许可证等）。</p> <h4 id="_1-生成"><a href="#_1-生成" class="header-anchor">#</a> 1. 生成</h4> <p>package.json文件可以手工编写，也可以使用 <code>npm init</code> 命令自动生成。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$ npm init
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这个命令采用互动方式，要求用户回答一些问题，然后在当前目录生成一个基本的package.json文件。所有问题之中，只有项目名称（name）和项目版本（version）是必填的，其他都是选填的。并将你的配置写成一个package.json文件。</p> <p>可以使用了<code>-f</code> 或者 <code>-y</code> 参数，生成一个默认的package.json文件。</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token operator">-</span>f  （force：强制生成，无现任何交互提问）
npm init <span class="token operator">-</span>f

<span class="token operator">-</span>y （所有交互提问都回答 “yes”）
npm init <span class="token operator">-</span>y
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_2-安装模块"><a href="#_2-安装模块" class="header-anchor">#</a> 2. 安装模块</h4> <h5 id="局部安装"><a href="#局部安装" class="header-anchor">#</a> 局部安装</h5> <p>npm默认将下载的模块安装到当前目录的node_modules 子目录下，称为局部安装。node.js 的 require 在加载模块时会尝试搜寻当前node_modules子目录，因此使用npm 本地模式安装的包可以直接被引用。</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>安装该包最新版本，并写入package<span class="token punctuation">.</span>json文件的dependencies字段<span class="token punctuation">,</span><span class="token punctuation">(</span>默认就是<span class="token operator">--</span>save，可省略，简写：<span class="token operator">-</span>S<span class="token punctuation">)</span>
npm install package <span class="token operator">--</span>save

安装该包的最新版本，并写入package<span class="token punctuation">.</span>json文件的devDependencies字段。（<span class="token operator">--</span>save<span class="token operator">-</span>dev 简写： <span class="token operator">-</span>D）
npm install package <span class="token operator">--</span>save<span class="token operator">-</span>dev   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>–-save-dev： 是开发过程中的使用的文件，一般是构建工具</p> <p>–-save： 是发布之后还依赖的文件</p> <p><strong>注意：如果安装包的文件名与当前目录名称相同，将无法安装。</strong></p> <h5 id="全局安装"><a href="#全局安装" class="header-anchor">#</a> 全局安装</h5> <p>全局安装，可以视为一个（没有图形界面）应用程序，可在全局<strong>以命令行方式</strong>直接调用。</p> <p>全局安装目录：<strong>C:\Users\用户名\AppData\Roaming\npm</strong></p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>全局安装 <span class="token operator">-</span>g参数    
npm install package <span class="token operator">-</span>g
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="全局与本地的区别"><a href="#全局与本地的区别" class="header-anchor">#</a> 全局与本地的区别</h5> <table><thead><tr><th>模式</th> <th>功能</th> <th>可以通过require使用</th> <th>注册全局PATH</th></tr></thead> <tbody><tr><td>本地模式</td> <td>作为项目运行时的（依赖）一部分</td> <td>是</td> <td>否</td></tr> <tr><td>全局模式</td> <td>可在全局<strong>以命令行方式</strong>直接调用的应用程序</td> <td>否</td> <td>是</td></tr></tbody></table> <h4 id="_3-卸载模块"><a href="#_3-卸载模块" class="header-anchor">#</a> 3. 卸载模块</h4> <div class="language-c line-numbers-mode"><pre class="language-c"><code>卸载全局安装包
npm uninstall  package <span class="token operator">-</span>g
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_4-安装指定版本"><a href="#_4-安装指定版本" class="header-anchor">#</a> 4. 安装指定版本</h4> <table><thead><tr><th>版本标记</th> <th>说明</th></tr></thead> <tbody><tr><td>1.2.2</td> <td>遵循“大版本.次要版本.小版本”的格式规定，安装时只安装指定版本</td></tr> <tr><td>~1.2.2</td> <td>表示安装1.2.x的最新版本（不低于1.2.2），但是不安装1.3.x<br>也就是说安装时不改变大版本号和次要版本号。</td></tr> <tr><td>ˆ1.2.2</td> <td>表示安装1.x.x的最新版本（不低于1.2.2），但是不安装2.x.x</td></tr> <tr><td>&gt;=1.2.0 &lt;1.3.0</td> <td>大于1.2.2版 小于1.3.0</td></tr></tbody></table> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install --save-dev package@版本号 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_5-package-lock-json"><a href="#_5-package-lock-json" class="header-anchor">#</a> 5. package-lock.json</h4> <p>普通的package.json的库前面的版本写法默认是^开头。假如一个库的版本是^2.0，npm 安装的时候并不是一定是安装的2.0,而是大于等于这个版本。</p> <p>因为npm 是开源世界，各库包的版本语义可能并不相同，在完全相同的一个nodejs的代码库，在不同时间或者不同npm 下载源（<a href="https://yarnpkg.com/zh-Hans/" target="_blank" rel="noopener noreferrer">yarn<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 是 Facebook 提供的替代npm 的工具）之下，下载到的各依赖库包版本可能有所不同，因此其依赖库包行为特征也不同，甚至完全不兼容。</p> <p>因此npm最新的版本就开始提供自动生成package-lock.json功能，为的是让开发者知道只要你保存了源文件，到一个新的机器上、或者新的下载源，只要按照这个package-lock.json所标示的具体版本下载依赖库包，就能确保所有库包与你上次安装的完全一样。</p> <h4 id="_6-项目重建与迁移"><a href="#_6-项目重建与迁移" class="header-anchor">#</a> 6. 项目重建与迁移</h4> <p>迁移项目不用复制node_modules目录，复制 <code>package.json</code> 和 <code>package-lock.json</code>文件到其他地方，直接运行<strong>npm install</strong>命令，就会按照package.json里面的配置内容，在当前目录中安装所需模块，重建相同项目。</p> <h2 id="第二章-package-json主要字段"><a href="#第二章-package-json主要字段" class="header-anchor">#</a> 第二章 package.json主要字段</h2> <p>如果只</p> <h3 id="第一节-scripts字段"><a href="#第一节-scripts字段" class="header-anchor">#</a> 第一节 scripts字段</h3> <p>以命令行方式运行程序，通常输入的命令带有各种参数，会造成一条命令很长，操作不便。scripts里以 key：value 的方式定义shell脚本（操作系统可执行的命令）。也就是为一个很长命令行语句，定义成一个命令，使用 <strong>npm run</strong> 调用。</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>定义script脚本 
<span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;mytest&quot;</span><span class="token operator">:</span><span class="token string">&quot;node mytest.js&quot;</span>    
<span class="token punctuation">}</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
调用
npm run mytest
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_1-默认设置"><a href="#_1-默认设置" class="header-anchor">#</a> 1. 默认设置</h4> <p>npm会默认设置一些固定名称的命令，这些命令具有特殊用途：</p> <table><thead><tr><th>命令</th> <th>运行时机</th></tr></thead> <tbody><tr><td>test</td> <td>执行test（测试）时</td></tr> <tr><td>publish</td> <td>发布模块时</td></tr> <tr><td>install</td> <td>模块被安装时</td></tr> <tr><td>uninstall</td> <td>模块被卸载时</td></tr> <tr><td>start</td> <td>开始时<br>如果你项目根目录有一个server.js，并且，你又没自定义start，那么npm start就会执行server.js</td></tr> <tr><td>stop</td> <td>停止时</td></tr> <tr><td>restart</td> <td>重启时<br>没有自定义restart脚本，会执行：stop，start<br>自定义了restart脚本，会执行：prerestart, restart, postrestart</td></tr> <tr><td>version</td> <td>获取版本号时</td></tr></tbody></table> <h4 id="_2-简写"><a href="#_2-简写" class="header-anchor">#</a> 2. 简写</h4> <p>npm默认设置在运行时可以如下简写：</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>npm start <span class="token operator">==</span><span class="token operator">=</span> npm run start
npm stop <span class="token operator">==</span><span class="token operator">=</span> npm run stop
npm test <span class="token operator">==</span><span class="token operator">=</span> npm run test
npm restart <span class="token operator">==</span><span class="token operator">=</span> npm run rerestart 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>案例：编写一个脚本用来运行程序。</p> <h4 id="_3-生命周期与hook前缀"><a href="#_3-生命周期与hook前缀" class="header-anchor">#</a> 3. 生命周期与hook前缀</h4> <p>可以在执行某些命令前、后做一些操作，比如build前清空目录，build后做一些压缩。</p> <p>在每个命令前都会执行对应命令的pre+scriptname 脚本</p> <p>每个命令结束后会执行对应命令的post+scriptname脚本</p> <p>如果没有定义，则不会执行对应的pre ，post命令</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>scripts<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;prebuild&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;echo \&quot; this is pre build \&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;build&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;echo \&quot; this is build \&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;postbuild&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;echo \&quot; this is post build \&quot;&quot;</span>
<span class="token punctuation">}</span>

npm run build
输出<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span> 
this is pre build
this is build
this is post build  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h5 id="默认命令的生命周期"><a href="#默认命令的生命周期" class="header-anchor">#</a> 默认命令的生命周期</h5> <ul><li>prepublish：在模块被发布前（其实在安装本地包也会触发）</li> <li>publish, postpublish：在发布后执行</li> <li>preinstall：模块被安装前执行</li> <li>install：模块被安装时执行</li> <li>postinstall：模块安装后执行</li> <li>preuninstall, uninstall：模块被卸载前执行</li> <li>postuninstall：模块卸载后执行</li> <li>preversion, version：获取版本号前执行</li> <li>postversion：获取版本号之后执行</li> <li>pretest, test, posttest：执行test脚本时会执行</li> <li>prestop, stop, poststop：在脚本结束时执行</li> <li>prestart, start, poststart：调用start时执行</li> <li>prerestart, restart, postrestart：在执行restart时会调用</li></ul> <p>完整的生命周期脚本</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token string">&quot;scripts&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;pretest&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is pre test \&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;test&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is test \&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;posttest&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is post test \&quot;&quot;</span><span class="token punctuation">,</span>

    <span class="token string">&quot;prerestart&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is pre restart \&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;restart&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is restart \&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;postrestart&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is post restart \&quot;&quot;</span><span class="token punctuation">,</span>
     
    <span class="token string">&quot;prestop&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is pre stop \&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;stop&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is stop \&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;poststop&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is post stop \&quot;&quot;</span><span class="token punctuation">,</span>

    <span class="token string">&quot;prestart&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is pre start \&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;start&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is start \&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;poststart&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is post start \&quot;&quot;</span><span class="token punctuation">,</span>

    <span class="token string">&quot;preinstall&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is pre install \&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;install&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is install \&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;postinstall&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is post install \&quot;&quot;</span><span class="token punctuation">,</span>

    <span class="token string">&quot;prepublish&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is pre install \&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;publish&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is publish \&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;postpublish&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is post install \&quot;&quot;</span><span class="token punctuation">,</span>

    <span class="token string">&quot;preuninstall&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is pre uninstall \&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;uninstall&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is uninstall \&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;postuninstall&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is post uninstall \&quot;&quot;</span><span class="token punctuation">,</span>
     
    <span class="token string">&quot;prebuild&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is pre build \&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;build&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is build \&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;postbuild&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;echo \&quot; this is post build \&quot;&quot;</span>
<span class="token punctuation">}</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h3 id="第二节-dependencies与devdependencies字段"><a href="#第二节-dependencies与devdependencies字段" class="header-anchor">#</a> 第二节 dependencies与devDependencies字段</h3> <p><code>dependencies</code> 字段指定了项目运行所依赖的模块（--save 安装的模块），是生产环境中需要的依赖，即正常运行时所需要的依赖模块</p> <p><code>devDependencies</code> 指定项目开发所需要的模块（--save-dev 安装的模块）。比如：clean-css，我们用它压缩css文件，它们不会被部署到生产环境。</p> <h2 id="第三章-发布-npm-包"><a href="#第三章-发布-npm-包" class="header-anchor">#</a> 第三章 发布 npm 包</h2> <h3 id="第一节-发布前的准备"><a href="#第一节-发布前的准备" class="header-anchor">#</a> 第一节 发布前的准备</h3> <h4 id="_1-创建npm账号"><a href="#_1-创建npm账号" class="header-anchor">#</a> 1. 创建npm账号</h4> <ul><li>官网：<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.npmjs.com%2F" target="_blank" rel="noopener noreferrer">https://www.npmjs.com/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>创建账号入口：<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.npmjs.com%2Fsignup" target="_blank" rel="noopener noreferrer">https://www.npmjs.com/signup<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h4 id="_2-入口文件"><a href="#_2-入口文件" class="header-anchor">#</a> 2. 入口文件</h4> <p>默认的入口文件是项目根目录下的 <code>index.js</code> 文件。入口文件就是第三方导入<code>require</code>你的包时执行的代码。内容大体是这样。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Customer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./api/customer&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> Service <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./api/service&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// 导入时执行的代码</span>
console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 导出的内容</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>Customer<span class="token punctuation">,</span> Service<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_3-配置-package-json-文件"><a href="#_3-配置-package-json-文件" class="header-anchor">#</a> 3. 配置 <code>package.json</code> 文件</h4> <p>package.json 文件是使用 <code>npm init</code> 创建的。如果要发布给其他人使用，这个配置文件里的字段就很重要了。</p> <ul><li><p>name: 发布的包名，默认是上级文件夹名。不得与现在npm中的包名重复。包名不能有大写字母/空格/下滑线。</p></li> <li><p>version: 项目版本号，</p> <blockquote><p>对于npm包的版本号有着一系列的规则，模块的版本号采用X.Y.Z的格式：
1、修复bug，小改动，增加z。
2、增加新特性，可向后兼容，增加y。
3、有很大的改动，特别是无法向下兼容,增加x。</p></blockquote></li> <li><p>description: 项目描述</p></li> <li><p>author,contributors: 作者和贡献者</p></li> <li><p>main：入口文件，默认是Index.js。</p></li> <li><p>keywords: {Array}关键词，便于用户搜索到我们的项目</p></li> <li><p>homepage: 项目url主页</p></li> <li><p>bin：用来指定各个内部命令对应的可执行文件的位置。(较少用)</p></li> <li><p>bugs: 项目问题反馈的Url或email配置</p></li> <li><p>license: 项目许可证，让使用者知道是如何被允许使用此项目</p></li> <li><p>files: 包含在项目中的文件数组</p></li> <li><p>repository: 代码被托管在何处，这对那些想要参与到这个项目中的人来说很有帮助。</p></li> <li><p>engines：指明了该模块运行的平台，比如 Node 的某个版本或者浏览器。</p></li> <li><p>browser：指定该模板供浏览器使用的版本。</p></li> <li><p>config：用于添加命令行的环境变量。</p></li> <li><p>preferGlobal：表示当用户不将该模块安装为全局模块时（即不用–global参数），要不要显示警告。</p></li> <li><p>peerDependencies ：用来供插件指定其所需要的主工具的版本。</p></li> <li><p>style：指定供浏览器使用时，样式文件所在的位置。</p></li></ul> <h3 id="第二节-登录"><a href="#第二节-登录" class="header-anchor">#</a> 第二节 登录</h3> <h4 id="_1-本机第一次发布包"><a href="#_1-本机第一次发布包" class="header-anchor">#</a> 1. 本机第一次发布包</h4> <p>本机第一次发布包时，需要添加自己的用户信息，以后就不用了。项目根目录下，运行npm adduser命令即可。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> adduser
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在终端输入npm adduser后，会提示输入账号，密码和邮箱，并提示创建成功。</p> <p>最后一行显示登录信息，as 后面是用户名。on 后是源地址。国内很多用的是taobao的源 <code>http://registry.npm.taobao.org/</code> ，在发布时需要切换回官方的 <code>https://registry.npmjs.org/</code>  源。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> config <span class="token builtin class-name">set</span> registry https://registry.npmjs.org/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_2-登录"><a href="#_2-登录" class="header-anchor">#</a> 2. 登录</h4> <p>如果已经添加过用户信息，直接登录就可以了。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> login
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="第三节-发布"><a href="#第三节-发布" class="header-anchor">#</a> 第三节 发布</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> publish
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>发布完成后，在npm官网中自己的package里，会看到对应的包。</p> <h4 id="常见发布错误"><a href="#常见发布错误" class="header-anchor">#</a> 常见发布错误</h4> <h5 id="邮箱未验证"><a href="#邮箱未验证" class="header-anchor">#</a> 邮箱未验证</h5> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code>npm <span class="token constant">ERR</span><span class="token operator">!</span> publish <span class="token builtin">Failed</span> <span class="token constant">PUT</span> <span class="token number">403</span>
npm <span class="token constant">ERR</span><span class="token operator">!</span> code <span class="token builtin">E403</span>
npm <span class="token constant">ERR</span><span class="token operator">!</span> you must verify your email before publishing a <span class="token keyword">new</span> <span class="token class-name">package</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>npmjs<span class="token punctuation">.</span>com<span class="token operator">/</span>email<span class="token operator">-</span>edit <span class="token punctuation">:</span> your<span class="token operator">-</span>package
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这个是注册后没有验证邮箱，登录自己邮箱找到对应的邮件确认就好了。如果验证邮件过期的话登录自己的 npm 主页重新发一个就好了。</p> <h5 id="重名"><a href="#重名" class="header-anchor">#</a> 重名</h5> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code>npm <span class="token constant">ERR</span><span class="token operator">!</span> publish <span class="token builtin">Failed</span> <span class="token constant">PUT</span> <span class="token number">403</span>
npm <span class="token constant">ERR</span><span class="token operator">!</span> code <span class="token builtin">E403</span>
npm <span class="token constant">ERR</span><span class="token operator">!</span> <span class="token builtin">You</span> <span class="token keyword">do</span> not have permission to publish <span class="token string">&quot;your-package&quot;</span><span class="token punctuation">.</span> <span class="token builtin">Are</span> you logged <span class="token keyword">in</span> <span class="token keyword">as</span> the correct user<span class="token operator">?</span> <span class="token punctuation">:</span> your<span class="token operator">-</span>package
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>你的包和别人的包重名了，npm 里的包不允许重名，所以去 <a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.npmjs.com%2F" target="_blank" rel="noopener noreferrer">npm<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 搜一下，改个没人用的名字就可以了。</p> <h5 id="需要登录"><a href="#需要登录" class="header-anchor">#</a> 需要登录</h5> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code>npm <span class="token constant">ERR</span><span class="token operator">!</span> code <span class="token constant">ENEEDAUTH</span>
npm <span class="token constant">ERR</span><span class="token operator">!</span> need auth auth <span class="token keyword">required</span> <span class="token keyword">for</span> publishing
npm <span class="token constant">ERR</span><span class="token operator">!</span> need auth <span class="token builtin">You</span> need to authorize this machine using `npm adduser`
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>后面已经注明了，输入<code>npm adduser</code>重新登录就可以了，过程和<code>npm login</code>一样，这个问题在你切换了 npm 源之后或登录过期后都有可能发生。</p> <h5 id="只有管理员才有权限发布"><a href="#只有管理员才有权限发布" class="header-anchor">#</a> 只有管理员才有权限发布</h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code>npm ERR<span class="token operator">!</span> publish <span class="token class-name">Failed</span> PUT <span class="token number">403</span>
npm ERR<span class="token operator">!</span> code E403
npm ERR<span class="token operator">!</span> <span class="token punctuation">[</span>no_perms<span class="token punctuation">]</span> <span class="token class-name">Private</span> mode enable<span class="token punctuation">,</span> only admin can publish <span class="token keyword">this</span> <span class="token keyword">module</span> <span class="token punctuation">[</span>no_perms<span class="token punctuation">]</span> <span class="token class-name">Private</span> mode enable<span class="token punctuation">,</span> only admin can publish <span class="token keyword">this</span> <span class="token keyword">module</span><span class="token operator">:</span> your<span class="token operator">-</span><span class="token keyword">package</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这个是你的源设置成第三方源的时候才有可能发生，比如设置了淘宝源就<strong>可能</strong>会导致该问题。只要把源改回默认的就可以了，如下：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>npm config set registry http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>registry<span class="token punctuation">.</span>npmjs<span class="token punctuation">.</span>org
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="包名过于类似"><a href="#包名过于类似" class="header-anchor">#</a> 包名过于类似</h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code>npm ERR<span class="token operator">!</span> publish <span class="token class-name">Failed</span> PUT <span class="token number">403</span>
npm ERR<span class="token operator">!</span> code E403
npm ERR<span class="token operator">!</span> <span class="token class-name">Package</span> name too similar <span class="token keyword">to</span> existing packages<span class="token punctuation">;</span> <span class="token keyword">try</span> renaming your <span class="token keyword">package</span> <span class="token keyword">to</span> <span class="token string">'@hopgoldy/auto-git'</span> and publishing <span class="token keyword">with</span> <span class="token string">'npm publish --access=public'</span> instead <span class="token operator">:</span> your<span class="token operator">-</span><span class="token keyword">package</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>如果npm上已经有了不少和你的包名类似的包，就会出现这个问题，在<code>package.json</code>中修改你的包名就可以了</p> <h5 id="无法发布到私有包"><a href="#无法发布到私有包" class="header-anchor">#</a> 无法发布到私有包</h5> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code>npm <span class="token constant">ERR</span><span class="token operator">!</span> publish <span class="token builtin">Failed</span> <span class="token constant">PUT</span> <span class="token number">402</span>
npm <span class="token constant">ERR</span><span class="token operator">!</span> code <span class="token builtin">E402</span>
npm <span class="token constant">ERR</span><span class="token operator">!</span> <span class="token builtin">You</span> must sign up <span class="token keyword">for</span> <span class="token keyword">private</span> packages <span class="token punctuation">:</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这个当你的包名为<code>@your-name/your-package</code>时才会出现，原因是当包名以<code>@your-name</code>开头时，<code>npm publish</code>会默认发布为私有包，但是 npm 的私有包需要付费，所以需要添加如下参数进行发布:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>npm publish <span class="token operator">--</span>access <span class="token keyword">public</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="需要提高版本号"><a href="#需要提高版本号" class="header-anchor">#</a> 需要提高版本号</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#1、发包 npm publish 失败</span>
sh-neverleave:z-tool neverleave$ <span class="token function">npm</span> publish
<span class="token function">npm</span> ERR<span class="token operator">!</span> publish Failed PUT <span class="token number">400</span>
<span class="token function">npm</span> ERR<span class="token operator">!</span> code E400
<span class="token function">npm</span> ERR<span class="token operator">!</span> deprecations must be strings <span class="token builtin class-name">:</span> z-tool

<span class="token function">npm</span> ERR<span class="token operator">!</span> A complete log of this run can be found in:
<span class="token function">npm</span> ERR<span class="token operator">!</span>     /Users/neverleave/.npm/_logs/2018-11-23T10_52_01_742Z-debug.log
sh-neverleave:z-tool neverleave$ <span class="token function">npm</span> publish


<span class="token comment">#2、发包 npm publish 失败</span>
sh-neverleave:z-tool neverleave$ <span class="token function">npm</span> publish
<span class="token function">npm</span> ERR<span class="token operator">!</span> publish Failed PUT <span class="token number">403</span>
<span class="token function">npm</span> ERR<span class="token operator">!</span> code E403
<span class="token function">npm</span> ERR<span class="token operator">!</span> You cannot publish over the previously published versions: <span class="token number">1.0</span>.3. <span class="token builtin class-name">:</span> z-tool

<span class="token function">npm</span> ERR<span class="token operator">!</span> A complete log of this run can be found in:
<span class="token function">npm</span> ERR<span class="token operator">!</span>     /Users/neverleave/.npm/_logs/2018-11-23T11_24_57_662Z-debug.log
sh-neverleave:z-tool neverleave$ 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h5 id="确保登录的用户账号正确"><a href="#确保登录的用户账号正确" class="header-anchor">#</a> 确保登录的用户账号正确</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>sh-neverleave:npm neverleave$ <span class="token function">npm</span> publish
<span class="token function">npm</span> ERR<span class="token operator">!</span> publish Failed PUT <span class="token number">404</span>
<span class="token function">npm</span> ERR<span class="token operator">!</span> code E404
<span class="token function">npm</span> ERR<span class="token operator">!</span> <span class="token number">404</span> User not found <span class="token builtin class-name">:</span> z-tool
<span class="token function">npm</span> ERR<span class="token operator">!</span> <span class="token number">404</span> 
<span class="token function">npm</span> ERR<span class="token operator">!</span> <span class="token number">404</span>  <span class="token string">'z-tool'</span> is not <span class="token keyword">in</span> the <span class="token function">npm</span> registry.
<span class="token function">npm</span> ERR<span class="token operator">!</span> <span class="token number">404</span> You should bug the author to publish it <span class="token punctuation">(</span>or use the name yourself<span class="token operator">!</span><span class="token punctuation">)</span>
<span class="token function">npm</span> ERR<span class="token operator">!</span> <span class="token number">404</span> 
<span class="token function">npm</span> ERR<span class="token operator">!</span> <span class="token number">404</span> Note that you can also <span class="token function">install</span> from a
<span class="token function">npm</span> ERR<span class="token operator">!</span> <span class="token number">404</span> tarball, folder, http url, or <span class="token function">git</span> url.

<span class="token function">npm</span> ERR<span class="token operator">!</span> A complete log of this run can be found in:
<span class="token function">npm</span> ERR<span class="token operator">!</span>     /Users/neverleave/.npm/_logs/2018-11-23T07_32_28_518Z-debug.log
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="附录："><a href="#附录：" class="header-anchor">#</a> 附录：</h2> <h3 id="bin子目录"><a href="#bin子目录" class="header-anchor">#</a> .bin子目录</h3> <h4 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h4> <p>通过npm安装的部分依赖包，具有windows脚本命令，这些命令会保存到 <code>node_modules/.bin</code> 目录中，要运行这些命令，必须在 <code>package.json</code> 文件的 <code>scripts</code> 字段中定义，通过 <strong>npm run</strong>调用。npm run 运行时，会将<code>node_modules/.bin</code> 子目录加入 <code>PATH</code> 变量，执行结束后，再将 <code>PATH</code> 变量恢复原样。</p> <blockquote><p>windows脚本语言也是一种编程语言，也有自己专门的命令词汇、规范、用法。windows脚本也有不同的语言 如：VBScript、JScript， 他们都内嵌在windows中，不必安装，代码是纯文本，用记事本就能编写。</p> <p>window脚本文件有两种格式：<strong>cmd</strong> 和 <strong>bat</strong>，主要区别如下：</p> <table><thead><tr><th>区别</th> <th>cmd</th> <th>bat</th></tr></thead> <tbody><tr><td>运行环境</td> <td>32/64位windows系统（非早期16位dos系统）</td> <td>无限制</td></tr> <tr><td>描述</td> <td>windowsNT命令脚本</td> <td>ms-dos批处理文件</td></tr></tbody></table></blockquote> <h4 id="案例演示"><a href="#案例演示" class="header-anchor">#</a> 案例演示</h4> <ol><li><p>创建脚本文件</p> <p>在 <code>node_modules/.bin</code> 目录下创建 <code>mytest.cmd</code> 文件，内容如下：</p></li></ol> <div class="language-c line-numbers-mode"><pre class="language-c"><code>echo hello world
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="2"><li>在package.json文件的scripts字段中增加命令：</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token string">&quot;scripts&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
	<span class="token string">&quot;hello&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;mytest&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="3"><li>运行脚本</li></ol> <div class="language-c line-numbers-mode"><pre class="language-c"><code>npm run hello
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/li-kang/WebNotes/edit/master/docs/notes/Npm与Yarn包管理技术/readme.md" target="_blank" rel="noopener noreferrer">维护文档</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">9/15/2020, 8:32:27 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.36f33a9d.js" defer></script><script src="/assets/js/2.d27f56d2.js" defer></script><script src="/assets/js/23.cd435639.js" defer></script>
  </body>
</html>