<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Gulp自动化构建工具 | 技术学派</title>
    <meta name="description" content="Web前端技术、干货、教程、课程笔记">
    <link rel="icon" href="/favicon.ico">
  <meta name="robots" content="all">
  <meta name="author" content="likang">
  <meta name="keywords" content="Web全栈知识体系, web体系, web知识体系, web框架, web详解, web学习路线, web spring, web面试, 知识体系, web技术体系, web编程, web编程指南,web开发体系, web开发,web教程,web,web数据结构, 算法, 开发基础">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <script src="https://hm.baidu.com/hm.js?a2fd998a0322a08f10309f035d7009e1"></script>
    
    <link rel="preload" href="/assets/css/0.styles.c9eb7bf0.css" as="style"><link rel="preload" href="/assets/js/app.36f33a9d.js" as="script"><link rel="preload" href="/assets/js/2.d27f56d2.js" as="script"><link rel="preload" href="/assets/js/18.e8ce1763.js" as="script"><link rel="prefetch" href="/assets/js/10.d1e6c66a.js"><link rel="prefetch" href="/assets/js/11.29746d89.js"><link rel="prefetch" href="/assets/js/12.0605b152.js"><link rel="prefetch" href="/assets/js/13.3b6be312.js"><link rel="prefetch" href="/assets/js/14.e0cf0d42.js"><link rel="prefetch" href="/assets/js/15.86f20d18.js"><link rel="prefetch" href="/assets/js/16.a660308b.js"><link rel="prefetch" href="/assets/js/17.2c6ab243.js"><link rel="prefetch" href="/assets/js/19.34c3af53.js"><link rel="prefetch" href="/assets/js/20.3fa7618a.js"><link rel="prefetch" href="/assets/js/21.4c157aad.js"><link rel="prefetch" href="/assets/js/22.47eb5636.js"><link rel="prefetch" href="/assets/js/23.cd435639.js"><link rel="prefetch" href="/assets/js/24.990a63e1.js"><link rel="prefetch" href="/assets/js/25.47122bec.js"><link rel="prefetch" href="/assets/js/26.05b4f7ae.js"><link rel="prefetch" href="/assets/js/27.9ab1d9bc.js"><link rel="prefetch" href="/assets/js/28.50943c3b.js"><link rel="prefetch" href="/assets/js/29.bd08d43b.js"><link rel="prefetch" href="/assets/js/3.2c8e19c4.js"><link rel="prefetch" href="/assets/js/30.cd670f1e.js"><link rel="prefetch" href="/assets/js/31.fc962975.js"><link rel="prefetch" href="/assets/js/32.16de1a8c.js"><link rel="prefetch" href="/assets/js/33.5331101e.js"><link rel="prefetch" href="/assets/js/34.1df38d3f.js"><link rel="prefetch" href="/assets/js/35.2e0c63f6.js"><link rel="prefetch" href="/assets/js/4.e3d63e9c.js"><link rel="prefetch" href="/assets/js/5.0fc728f0.js"><link rel="prefetch" href="/assets/js/6.596668dc.js"><link rel="prefetch" href="/assets/js/7.5a102747.js"><link rel="prefetch" href="/assets/js/8.53b312d6.js"><link rel="prefetch" href="/assets/js/9.0ec4f429.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c9eb7bf0.css">   
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">技术学派</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/notes/" class="nav-link router-link-active">主线课程大纲</a></div><div class="nav-item"><a href="/techs.html" class="nav-link">技术栈</a></div><div class="nav-item"><a href="/nav.html" class="nav-link">网站导航</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端编码规范" class="dropdown-title"><span class="title">前端编码规范</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/rules/html.html" class="nav-link">HTML 编码规范</a></li><li class="dropdown-item"><!----> <a href="/rules/css.html" class="nav-link">CSS 编码规范</a></li><li class="dropdown-item"><!----> <a href="/rules/js.html" class="nav-link">JavaScript 编码规范</a></li><li class="dropdown-item"><!----> <a href="/specification.html" class="nav-link">文档编写规范</a></li></ul></div></div><div class="nav-item"><a href="/tips.html" class="nav-link">学习建议</a></div><div class="nav-item"><a href="/discuss.html" class="nav-link">留言</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/notes/" class="nav-link router-link-active">主线课程大纲</a></div><div class="nav-item"><a href="/techs.html" class="nav-link">技术栈</a></div><div class="nav-item"><a href="/nav.html" class="nav-link">网站导航</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端编码规范" class="dropdown-title"><span class="title">前端编码规范</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/rules/html.html" class="nav-link">HTML 编码规范</a></li><li class="dropdown-item"><!----> <a href="/rules/css.html" class="nav-link">CSS 编码规范</a></li><li class="dropdown-item"><!----> <a href="/rules/js.html" class="nav-link">JavaScript 编码规范</a></li><li class="dropdown-item"><!----> <a href="/specification.html" class="nav-link">文档编写规范</a></li></ul></div></div><div class="nav-item"><a href="/tips.html" class="nav-link">学习建议</a></div><div class="nav-item"><a href="/discuss.html" class="nav-link">留言</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Gulp自动化构建工具</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/Gulp%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/#第一章-gulp-介绍" class="sidebar-link">第一章 gulp 介绍</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/Gulp%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/#第一节-gulp-的作用" class="sidebar-link">第一节 gulp 的作用</a></li><li class="sidebar-sub-header"><a href="/notes/Gulp%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/#第二节-安装-gulp" class="sidebar-link">第二节 安装 gulp</a></li><li class="sidebar-sub-header"><a href="/notes/Gulp%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/#第三节-项目的常规目录结构" class="sidebar-link">第三节 项目的常规目录结构</a></li></ul></li><li><a href="/notes/Gulp%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/#第二章-gulp-中的命令和管道" class="sidebar-link">第二章 gulp 中的命令和管道</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/Gulp%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/#第一节-task命令" class="sidebar-link">第一节 task命令</a></li><li class="sidebar-sub-header"><a href="/notes/Gulp%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/#第二节-src命令" class="sidebar-link">第二节 src命令</a></li><li class="sidebar-sub-header"><a href="/notes/Gulp%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/#第三节-dest命令" class="sidebar-link">第三节  dest命令</a></li><li class="sidebar-sub-header"><a href="/notes/Gulp%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/#第四节-series命令" class="sidebar-link">第四节 series命令</a></li><li class="sidebar-sub-header"><a href="/notes/Gulp%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/#第五节-watch命令" class="sidebar-link">第五节 watch命令</a></li></ul></li><li><a href="/notes/Gulp%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/#第三章-gulp-常见任务及插件" class="sidebar-link">第三章 gulp 常见任务及插件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/Gulp%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/#第一节-编译" class="sidebar-link">第一节 编译</a></li><li class="sidebar-sub-header"><a href="/notes/Gulp%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/#第二节-自动注入" class="sidebar-link">第二节 自动注入</a></li><li class="sidebar-sub-header"><a href="/notes/Gulp%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/#第三节-压缩" class="sidebar-link">第三节 压缩</a></li><li class="sidebar-sub-header"><a href="/notes/Gulp%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/#第四节-文件操作" class="sidebar-link">第四节 文件操作</a></li><li class="sidebar-sub-header"><a href="/notes/Gulp%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/#第五节-工具" class="sidebar-link">第五节 工具</a></li><li class="sidebar-sub-header"><a href="/notes/Gulp%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/#案例：less-文件的自动化处理" class="sidebar-link">案例：less 文件的自动化处理</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="gulp自动化构建工具"><a href="#gulp自动化构建工具" class="header-anchor">#</a> Gulp自动化构建工具</h1> <h2 id="第一章-gulp-介绍"><a href="#第一章-gulp-介绍" class="header-anchor">#</a> 第一章 gulp 介绍</h2> <h3 id="第一节-gulp-的作用"><a href="#第一节-gulp-的作用" class="header-anchor">#</a> 第一节 gulp 的作用</h3> <p>gulp 将开发流程中让人痛苦或耗时的任务自动化，从而减少你所浪费的时间、创造更大价值。</p> <h3 id="第二节-安装-gulp"><a href="#第二节-安装-gulp" class="header-anchor">#</a> 第二节 安装 gulp</h3> <ol start="2"><li><p>gulp 是构建工具，所以只在开发时使用。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> gulp --save-dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>创建<code>gulpfile.js</code>文件</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ol> <h3 id="第三节-项目的常规目录结构"><a href="#第三节-项目的常规目录结构" class="header-anchor">#</a> 第三节 项目的常规目录结构</h3> <p><code>src文件夹</code>  是源码文件。</p> <p><code>dist文件夹</code> 是编译后或者压缩后终发布版本的代码 。</p> <h2 id="第二章-gulp-中的命令和管道"><a href="#第二章-gulp-中的命令和管道" class="header-anchor">#</a> 第二章 gulp 中的命令和管道</h2> <ul><li>gulp 只有5个 API <code>task</code>、<code>src</code>、<code>dest</code>、<code>serise</code>、<code>watch</code>。</li> <li><code>src</code>、<code>dest</code>、<code>watch</code>通常都在 <code>task</code> 内使用</li> <li>在项目根目录下创建一个名为 <code>gulpfile.js</code> 的文件，这是一个普通的javascript 文件。</li> <li>通过 require 引入 gulp。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="第一节-task命令"><a href="#第一节-task命令" class="header-anchor">#</a> 第一节 <code>task</code>命令</h3> <ul><li><code>task</code>命令用来创建任务</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建一个叫 hello 任务</span>
<span class="token comment">// 当执行这个任务时，function 就会被调用。</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hello World.'</span><span class="token punctuation">)</span>
    <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>当执行这个任务时，function 就会被调用。</li></ul> <h4 id="安装命令行工具"><a href="#安装命令行工具" class="header-anchor">#</a> 安装命令行工具</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> -g gulp-cli
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="执行任务"><a href="#执行任务" class="header-anchor">#</a> 执行任务</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>gulp hello
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="默认任务"><a href="#默认任务" class="header-anchor">#</a> 默认任务</h4> <p>使用<code>default</code>命名的任务为默认任务</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'default task running'</span><span class="token punctuation">)</span>
    <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>如果任务名是 default，就可以省略 gulp 调用时的任务名。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">## 执行 build 任务</span>
gulp build

<span class="token comment">## 执行 default 任务</span>
gulp
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="第二节-src命令"><a href="#第二节-src命令" class="header-anchor">#</a> 第二节 <code>src</code>命令</h3> <ul><li><code>src</code>命令用来指定对哪些文件进行操作。</li> <li>指定文件时可以使用 <code>glob</code> 正则表达式。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'build'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'src/css/**/*.less'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="glob-匹配符"><a href="#glob-匹配符" class="header-anchor">#</a> <code>glob</code> 匹配符</h4> <ul><li>*、**、！、{}</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'./js/*.js'</span><span class="token punctuation">)</span>               <span class="token comment">// * 匹配js文件夹下所有.js格式的文件</span>
gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'./js/**/*.js'</span><span class="token punctuation">)</span>            <span class="token comment">// ** 匹配js文件夹的0个或多个子文件夹</span>
gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'./js/*.js'</span><span class="token punctuation">,</span><span class="token string">'!./js/index.js'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment">// ! 匹配除了index.js之外的所有js文件</span>
gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'./js/**/{omui,common}.js'</span><span class="token punctuation">)</span>        <span class="token comment">// {} 匹配{}里的文件名</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="pipe管道"><a href="#pipe管道" class="header-anchor">#</a> <code>pipe</code>管道</h4> <ul><li>用<code>src</code>命令指定好文件后，就可以使用<code>pipe</code>管道来一环一环的处理了。</li> <li>一个文件流可以经过多个<code>pipe</code>管道。</li> <li>每个<code>pipe</code>管道相当于一条流水线上的一个工人，每个工人都会对这个文件流做一些加工，比如编译、加版权信息、压缩、发布等。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'build'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'src/css/**/*.less'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="第三节-dest命令"><a href="#第三节-dest命令" class="header-anchor">#</a> 第三节  <code>dest</code>命令</h3> <ul><li><code>src</code>指定文件通过一个一个的 pipe 进行处理，最后通过 <code>dest</code> 将处理后的文件保存到指定位置。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'css'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'src/css/**/*.less'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'dist/css/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="第四节-series命令"><a href="#第四节-series命令" class="header-anchor">#</a> 第四节 <code>series</code>命令</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span> gulp<span class="token punctuation">.</span><span class="token function">series</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token string">'css'</span><span class="token punctuation">,</span> <span class="token string">'js'</span><span class="token punctuation">,</span> <span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="第五节-watch命令"><a href="#第五节-watch命令" class="header-anchor">#</a> 第五节 <code>watch</code>命令</h3> <ul><li><code>watch</code>命令用来指定具体监控哪些文件的变动。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'watch'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token string">'**/*.less'</span><span class="token punctuation">,</span> gulp<span class="token punctuation">.</span><span class="token function">serious</span><span class="token punctuation">(</span><span class="token string">'build'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//监听目录下的文件，若文件发生变化，则调用build任务。</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="第三章-gulp-常见任务及插件"><a href="#第三章-gulp-常见任务及插件" class="header-anchor">#</a> 第三章 gulp 常见任务及插件</h2> <ul><li>gulp 中有几个函数，能做的事非常有限，他只提供了一个平台，具体的每一个功能由一个插件提供。</li> <li>使用插件一般可以分为以下步骤：</li></ul> <ol><li>安装插件包。<code>npm install gulp-less --save-dev</code></li> <li>引入插件。<code>const less = require(&quot;gulp-less&quot;);</code></li> <li>在task任务或者pipe管道中 调用插件函数。<code>.pipe(less())</code></li></ol> <h3 id="第一节-编译"><a href="#第一节-编译" class="header-anchor">#</a> 第一节 编译</h3> <h4 id="_1-gulp-less（编译less）"><a href="#_1-gulp-less（编译less）" class="header-anchor">#</a> 1. gulp-less（编译Less）</h4> <ul><li>把less文件转换为css。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>var gulp = require('gulp'),
    less = require(&quot;gulp-less&quot;);

gulp.task('compile-less', function () {
    gulp.src('less/*.less')
    .pipe(less())
    .pipe(gulp.dest('dist/css'));
});
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_2-gulp-sass（编译sass）"><a href="#_2-gulp-sass（编译sass）" class="header-anchor">#</a> 2. gulp-sass（编译Sass）</h4> <ul><li>把scss文件转换为sass文件。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>var gulp = require('gulp'),
    sass = require(&quot;gulp-sass&quot;);

gulp.task('compile-sass', function () {
    gulp.src('sass/*.sass')
    .pipe(sass())
    .pipe(gulp.dest('dist/css'));
});
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_3-gulp-babel"><a href="#_3-gulp-babel" class="header-anchor">#</a> 3. gulp-babel</h4> <ul><li>将ES6代码编译成ES5。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>var babel = require('gulp-babel');

gulp.src('./js/index.js')
    .pipe(babel({
        presets: ['es2015']
    }))
    .pipe(gulp.dest('./dist'))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_4-gulp-autoprefixer"><a href="#_4-gulp-autoprefixer" class="header-anchor">#</a> 4. gulp-autoprefixer</h4> <ul><li>增加浏览器的私有前缀。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> autoprefixer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'src/css/*.css'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">autoprefixer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            browsers<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'&gt; 5%'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            cascade<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//是否美化属性值 默认：true</span>
            remove<span class="token punctuation">:</span><span class="token boolean">true</span> <span class="token operator">/</span><span class="token operator">/</span>是否去掉不必要的前缀 默认：<span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'dist/css'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="第二节-自动注入"><a href="#第二节-自动注入" class="header-anchor">#</a> 第二节 自动注入</h3> <h4 id="_1-header"><a href="#_1-header" class="header-anchor">#</a> 1. header</h4> <h4 id="_2-gulp-useref"><a href="#_2-gulp-useref" class="header-anchor">#</a> 2. gulp-useref</h4> <ul><li>合并文件。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>// index.html

&lt;!-- build:css /css/all.css --&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;css/normalize.css&quot;&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;css/main.css&quot;&gt;
&lt;!-- endbuild --&gt;

// gulpfile.js

var useref = require('gulp-useref');

gulp.src('index.html')
    .pipe(useref())
    .pipe(gulp.dest('./dist'))
    
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>替换之后的index.html中就会变成：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;link rel=&quot;stylesheet&quot; href=&quot;css/all.css&quot;&gt;  // 之前的两个&lt;link&gt;替换成一个了
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="第三节-压缩"><a href="#第三节-压缩" class="header-anchor">#</a> 第三节 压缩</h3> <h4 id="_1-gulp-uglify"><a href="#_1-gulp-uglify" class="header-anchor">#</a> 1. gulp-uglify</h4> <ul><li>javascript代码优化工具，可以解析，压缩和美化javascript。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>var uglify = require(&quot;gulp-uglify&quot;);

gulp.src('./hello.js')
    .pipe(uglify())                 // 直接压缩hello.js
    .pipe(gulp.dest('./dist'))
    
 gulp.src('./hello.js')
    .pipe(uglify({
        mangle: true,               // 是否修改变量名，默认为 true
        compress: true,             // 是否完全压缩，默认为 true
        preserveComments: 'all'     // 保留所有注释
    }))
    .pipe(gulp.dest('./dist'))
    
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="_2-gulp-clean-css"><a href="#_2-gulp-clean-css" class="header-anchor">#</a> 2. gulp-clean-css</h4> <ul><li>压缩css文件。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>var gulp = require('gulp');
var cleanCss = require('gulp-clean-css');

gulp.task('compress-css', function() {
  return gulp.src('src/css/*.css')
    .pipe(cleanCss())
    .pipe(gulp.dest('dist/'));
});
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_3-gulp-minify-html"><a href="#_3-gulp-minify-html" class="header-anchor">#</a> 3. gulp-minify-html</h4> <ul><li>压缩html文件。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>var gulp = require('gulp');
var htmlmini = require('gulp-minify-html');

gulp.task('htmlmini', function () {
    gulp.src('*.html')
        .pipe(htmlmini())
        .pipe(gulp.dest('minihtml'));
})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_4-gulp-imagemin"><a href="#_4-gulp-imagemin" class="header-anchor">#</a> 4. gulp-imagemin</h4> <ul><li>压缩图片。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>var imagemin = require('gulp-imagemin');

gulp.src('./img/*.{jpg,png,gif,ico}')
    .pipe(imagemin())
    .pipe(gulp.dest('./dist/img'))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_5-gulp-zip"><a href="#_5-gulp-zip" class="header-anchor">#</a> 5. gulp-zip</h4> <ul><li>压缩成ZIP文件。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>var zip = require('gulp-zip');

gulp.src('./src/*')
    .pipe(zip('all.zip'))                   // 压缩成all.zip文件
    .pipe(gulp.dest('./dist'))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="第四节-文件操作"><a href="#第四节-文件操作" class="header-anchor">#</a> 第四节 文件操作</h3> <h4 id="_1-del"><a href="#_1-del" class="header-anchor">#</a> 1. del</h4> <ul><li>删除文件。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> del <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'del'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">del</span><span class="token punctuation">(</span><span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment">// 删除整个dist文件夹</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_2-gulp-rename"><a href="#_2-gulp-rename" class="header-anchor">#</a> 2. gulp-rename</h4> <ul><li>重命名文件。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> rename <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;gulp-rename&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'./hello.txt'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">rename</span><span class="token punctuation">(</span><span class="token string">'gb/goodbye.md'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">// 直接修改文件名和路径</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
 
gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'./hello.txt'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">rename</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    dirname<span class="token punctuation">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>                <span class="token comment">// 路径名</span>
    basename<span class="token punctuation">:</span> <span class="token string">&quot;goodbye&quot;</span><span class="token punctuation">,</span>            <span class="token comment">// 主文件名</span>
    prefix<span class="token punctuation">:</span> <span class="token string">&quot;pre-&quot;</span><span class="token punctuation">,</span>                 <span class="token comment">// 前缀</span>
    suffix<span class="token punctuation">:</span> <span class="token string">&quot;-min&quot;</span><span class="token punctuation">,</span>                 <span class="token comment">// 后缀</span>
    extname<span class="token punctuation">:</span> <span class="token string">&quot;.html&quot;</span>                <span class="token comment">// 扩展名</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ul><li>任务：
<ul><li>生成两个CSS文件，一个压缩的一个没有压缩的。</li> <li>给所有组件文件批量加前缀</li></ul></li></ul> <h4 id="_3-gulp-concat"><a href="#_3-gulp-concat" class="header-anchor">#</a> 3. gulp-concat</h4> <ul><li>合并文件。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> concat <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-concat'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'./js/*.js'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token string">'all.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>         <span class="token comment">// 合并all.js文件</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'./js/demo1.js'</span><span class="token punctuation">,</span><span class="token string">'./js/demo2.js'</span><span class="token punctuation">,</span><span class="token string">'./js/demo2.js'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token string">'all.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>         <span class="token operator">/</span><span class="token operator">/</span> 按照<span class="token punctuation">[</span><span class="token punctuation">]</span>里的顺序合并文件
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="_4-gulp-filter"><a href="#_4-gulp-filter" class="header-anchor">#</a> 4. gulp-filter</h4> <p>描述：在虚拟文件流中过滤文件。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> filter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-filter'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> f <span class="token operator">=</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'**'</span><span class="token punctuation">,</span> <span class="token string">'!*/index.js'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'js/**/*.js'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>                        <span class="token comment">// 过滤掉index.js这个文件</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> f1 <span class="token operator">=</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'**'</span><span class="token punctuation">,</span> <span class="token string">'!*/index.js'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>restore<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'js/**/*.js'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>f1<span class="token punctuation">)</span>                       <span class="token comment">// 过滤掉index.js这个文件</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">uglify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                 <span class="token comment">// 对其他文件进行压缩</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>f1<span class="token punctuation">.</span>restore<span class="token punctuation">)</span>               <span class="token comment">// 返回到未过滤执行的所有文件</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// 再对所有文件操作，包括index.js</span>
    
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="第五节-工具"><a href="#第五节-工具" class="header-anchor">#</a> 第五节 工具</h3> <h4 id="_1-gulp-load-plugins"><a href="#_1-gulp-load-plugins" class="header-anchor">#</a> 1. gulp-load-plugins</h4> <h4 id="_2-browser-sync"><a href="#_2-browser-sync" class="header-anchor">#</a> 2. browser-sync</h4> <ul><li>用来创建一个开发用的 Web 服务器。</li> <li>配合 <code>gulp.watch</code> 可以实现自动刷新。</li> <li>安装</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> browser-sync --save-dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>使用</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'serve'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  browserSync<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    server<span class="token punctuation">:</span> <span class="token string">&quot;./src&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  gulp<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token string">&quot;src/**/*.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> browserSync<span class="token punctuation">.</span>reload<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_3-gulp-jshint"><a href="#_3-gulp-jshint" class="header-anchor">#</a> 3. gulp-jshint</h4> <h3 id="案例：less-文件的自动化处理"><a href="#案例：less-文件的自动化处理" class="header-anchor">#</a> 案例：less 文件的自动化处理</h3> <p>按以下步骤实现：</p> <ol><li>编译 less。</li> <li>加私有前缀。</li> <li>压缩 CSS。</li> <li>重命名，加上.min 后缀。</li> <li>同时保存一份压缩版和一份未压缩版。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// less 文件的自动化处理</span>
<span class="token keyword">var</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> less <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-less'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> autoprefixer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> minifyCSS <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-minify-css'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> rename <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-rename'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> del <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'del'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'clear'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">del</span><span class="token punctuation">(</span><span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'build:src'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'src/css/**/*.less'</span><span class="token punctuation">)</span> <span class="token comment">// glob</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">less</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">autoprefixer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'dist/css/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">minifyCSS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">rename</span><span class="token punctuation">(</span><span class="token punctuation">{</span>suffix<span class="token punctuation">:</span><span class="token string">'.min'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'dist/css/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'watch'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    gulp<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token string">'**/*.less'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'build:src'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'clear'</span><span class="token punctuation">,</span> <span class="token string">'build:src'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/li-kang/WebNotes/edit/master/docs/notes/Gulp自动化构建工具/readme.md" target="_blank" rel="noopener noreferrer">维护文档</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">9/15/2020, 8:32:27 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.36f33a9d.js" defer></script><script src="/assets/js/2.d27f56d2.js" defer></script><script src="/assets/js/18.e8ce1763.js" defer></script>
  </body>
</html>