(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{292:function(s,t,a){"use strict";a.r(t);var n=a(1),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"npm与yarn包管理技术"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npm与yarn包管理技术"}},[s._v("#")]),s._v(" Npm与Yarn包管理技术")]),s._v(" "),a("h2",{attrs:{id:"第一章-npm入门"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一章-npm入门"}},[s._v("#")]),s._v(" 第一章 npm入门")]),s._v(" "),a("h3",{attrs:{id:"第一节-简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一节-简介"}},[s._v("#")]),s._v(" 第一节 简介")]),s._v(" "),a("p",[s._v("Nodejs自身提供了基本的模块，但是开发实际应用过程中仅仅依靠这些基本模块是远远不够的，那么如何获得其他模块文件？我开发的模块又如何分享给其他人使用呢？另外，即便拥有了这些模块，又该如何管理呢？")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.npmjs.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("npm"),a("OutboundLink")],1),s._v("（Node Package Manager）是随同NodeJS一起安装的。node根据"),a("a",{attrs:{href:"http://www.commonjs.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("common JS"),a("OutboundLink")],1),s._v("规范实现了包机制，并开发了npm来解决包的发布和获取需求，是NodeJS包管理和分发工具。")]),s._v(" "),a("p",[s._v("有了npm，可以很快的找到要使用的包，进行下载、安装以及管理已经安装的包。npm能解决NodeJS代码部署上的很多问题，常见的使用场景有：")]),s._v(" "),a("ul",[a("li",[s._v("从npm服务器下载第三方包到本地使用。")]),s._v(" "),a("li",[s._v("从npm服务器下载并安装第三方的命令行程序到本地使用。")]),s._v(" "),a("li",[s._v("将自己编写的包或命令行程序上传到npm服务器供别人使用。")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//查看npm版本")]),s._v("\n$ npm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.3")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("npm是一个独立软件（随同node一起安装），可以使用如下命令更新版本：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("npm install npm -g\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("由于npm官网服务器在境外，国内访问速度很慢，可以尝试使用淘宝在国内制作了一个"),a("a",{attrs:{href:"https://npm.taobao.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("淘宝npm镜像"),a("OutboundLink")],1),s._v("服务器，命令如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("npm config set registry https://registry.npm.taobao.org\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("查看当前镜像地址：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("npm get registry\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("淘宝镜像与npm官网的文件不能做到100%同步，还是建议首选npm官网。取消淘宝镜像（设置为npm官网）：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("npm config set registry https://registry.npmjs.org\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("blockquote",[a("p",[s._v("另外，还可以安装淘宝镜像"),a("strong",[s._v("cnpm")]),s._v("，使用 "),a("code",[s._v("cnpm install xxx")]),s._v(" 的方式安装模块（cnpm 安装的模块路径比较奇怪，不推荐使用）:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("npm install -g cnpm -registry=https://registry.npm.taobao.org\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("h3",{attrs:{id:"第二节-npm常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二节-npm常用命令"}},[s._v("#")]),s._v(" 第二节 npm常用命令")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("命令")]),s._v(" "),a("th",[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("npm init")]),s._v(" "),a("td",[s._v("初始化 package.json")])]),s._v(" "),a("tr",[a("td",[s._v("npm install")]),s._v(" "),a("td",[s._v("安装模块")])]),s._v(" "),a("tr",[a("td",[s._v("npm update")]),s._v(" "),a("td",[s._v("升级模块到最新版本")])]),s._v(" "),a("tr",[a("td",[s._v("npm run")]),s._v(" "),a("td",[s._v("运行package.json中 "),a("code",[s._v("scripts")]),s._v(" 字段的命令")])]),s._v(" "),a("tr",[a("td",[s._v("npm uninstall")]),s._v(" "),a("td",[s._v("卸载包")])])])]),s._v(" "),a("h3",{attrs:{id:"第三节-package-json"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三节-package-json"}},[s._v("#")]),s._v(" 第三节 package.json")]),s._v(" "),a("p",[s._v("每个项目的根目录下面，都有一个package.json文件，记录了这个项目所需要的各种模块，以及项目的配置信息（比如名称、版本、许可证等）。")]),s._v(" "),a("h4",{attrs:{id:"_1-生成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-生成"}},[s._v("#")]),s._v(" 1. 生成")]),s._v(" "),a("p",[s._v("package.json文件可以手工编写，也可以使用 "),a("code",[s._v("npm init")]),s._v(" 命令自动生成。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("$ npm init\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这个命令采用互动方式，要求用户回答一些问题，然后在当前目录生成一个基本的package.json文件。所有问题之中，只有项目名称（name）和项目版本（version）是必填的，其他都是选填的。并将你的配置写成一个package.json文件。")]),s._v(" "),a("p",[s._v("可以使用了"),a("code",[s._v("-f")]),s._v(" 或者 "),a("code",[s._v("-y")]),s._v(" 参数，生成一个默认的package.json文件。")]),s._v(" "),a("div",{staticClass:"language-c line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f  （force：强制生成，无现任何交互提问）\nnpm init "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("y （所有交互提问都回答 “yes”）\nnpm init "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("y\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h4",{attrs:{id:"_2-安装模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-安装模块"}},[s._v("#")]),s._v(" 2. 安装模块")]),s._v(" "),a("h5",{attrs:{id:"局部安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#局部安装"}},[s._v("#")]),s._v(" 局部安装")]),s._v(" "),a("p",[s._v("npm默认将下载的模块安装到当前目录的node_modules 子目录下，称为局部安装。node.js 的 require 在加载模块时会尝试搜寻当前node_modules子目录，因此使用npm 本地模式安装的包可以直接被引用。")]),s._v(" "),a("div",{staticClass:"language-c line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[s._v("安装该包最新版本，并写入package"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json文件的dependencies字段"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("默认就是"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("save，可省略，简写："),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("S"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nnpm install package "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("save\n\n安装该包的最新版本，并写入package"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json文件的devDependencies字段。（"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("save"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dev 简写： "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("D）\nnpm install package "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("save"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dev   \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("–-save-dev： 是开发过程中的使用的文件，一般是构建工具")]),s._v(" "),a("p",[s._v("–-save： 是发布之后还依赖的文件")]),s._v(" "),a("p",[a("strong",[s._v("注意：如果安装包的文件名与当前目录名称相同，将无法安装。")])]),s._v(" "),a("h5",{attrs:{id:"全局安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#全局安装"}},[s._v("#")]),s._v(" 全局安装")]),s._v(" "),a("p",[s._v("全局安装，可以视为一个（没有图形界面）应用程序，可在全局"),a("strong",[s._v("以命令行方式")]),s._v("直接调用。")]),s._v(" "),a("p",[s._v("全局安装目录："),a("strong",[s._v("C:\\Users\\用户名\\AppData\\Roaming\\npm")])]),s._v(" "),a("div",{staticClass:"language-c line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[s._v("全局安装 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("g参数    \nnpm install package "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("g\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h5",{attrs:{id:"全局与本地的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#全局与本地的区别"}},[s._v("#")]),s._v(" 全局与本地的区别")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("模式")]),s._v(" "),a("th",[s._v("功能")]),s._v(" "),a("th",[s._v("可以通过require使用")]),s._v(" "),a("th",[s._v("注册全局PATH")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("本地模式")]),s._v(" "),a("td",[s._v("作为项目运行时的（依赖）一部分")]),s._v(" "),a("td",[s._v("是")]),s._v(" "),a("td",[s._v("否")])]),s._v(" "),a("tr",[a("td",[s._v("全局模式")]),s._v(" "),a("td",[s._v("可在全局"),a("strong",[s._v("以命令行方式")]),s._v("直接调用的应用程序")]),s._v(" "),a("td",[s._v("否")]),s._v(" "),a("td",[s._v("是")])])])]),s._v(" "),a("h4",{attrs:{id:"_3-卸载模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-卸载模块"}},[s._v("#")]),s._v(" 3. 卸载模块")]),s._v(" "),a("div",{staticClass:"language-c line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[s._v("卸载全局安装包\nnpm uninstall  package "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("g\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"_4-安装指定版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-安装指定版本"}},[s._v("#")]),s._v(" 4. 安装指定版本")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("版本标记")]),s._v(" "),a("th",[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("1.2.2")]),s._v(" "),a("td",[s._v("遵循“大版本.次要版本.小版本”的格式规定，安装时只安装指定版本")])]),s._v(" "),a("tr",[a("td",[s._v("~1.2.2")]),s._v(" "),a("td",[s._v("表示安装1.2.x的最新版本（不低于1.2.2），但是不安装1.3.x"),a("br"),s._v("也就是说安装时不改变大版本号和次要版本号。")])]),s._v(" "),a("tr",[a("td",[s._v("ˆ1.2.2")]),s._v(" "),a("td",[s._v("表示安装1.x.x的最新版本（不低于1.2.2），但是不安装2.x.x")])]),s._v(" "),a("tr",[a("td",[s._v(">=1.2.0 <1.3.0")]),s._v(" "),a("td",[s._v("大于1.2.2版 小于1.3.0")])])])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("npm install --save-dev package@版本号 \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_5-package-lock-json"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-package-lock-json"}},[s._v("#")]),s._v(" 5. package-lock.json")]),s._v(" "),a("p",[s._v("普通的package.json的库前面的版本写法默认是^开头。假如一个库的版本是^2.0，npm 安装的时候并不是一定是安装的2.0,而是大于等于这个版本。")]),s._v(" "),a("p",[s._v("因为npm 是开源世界，各库包的版本语义可能并不相同，在完全相同的一个nodejs的代码库，在不同时间或者不同npm 下载源（"),a("a",{attrs:{href:"https://yarnpkg.com/zh-Hans/",target:"_blank",rel:"noopener noreferrer"}},[s._v("yarn"),a("OutboundLink")],1),s._v(" 是 Facebook 提供的替代npm 的工具）之下，下载到的各依赖库包版本可能有所不同，因此其依赖库包行为特征也不同，甚至完全不兼容。")]),s._v(" "),a("p",[s._v("因此npm最新的版本就开始提供自动生成package-lock.json功能，为的是让开发者知道只要你保存了源文件，到一个新的机器上、或者新的下载源，只要按照这个package-lock.json所标示的具体版本下载依赖库包，就能确保所有库包与你上次安装的完全一样。")]),s._v(" "),a("h4",{attrs:{id:"_6-项目重建与迁移"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-项目重建与迁移"}},[s._v("#")]),s._v(" 6. 项目重建与迁移")]),s._v(" "),a("p",[s._v("迁移项目不用复制node_modules目录，复制 "),a("code",[s._v("package.json")]),s._v(" 和 "),a("code",[s._v("package-lock.json")]),s._v("文件到其他地方，直接运行"),a("strong",[s._v("npm install")]),s._v("命令，就会按照package.json里面的配置内容，在当前目录中安装所需模块，重建相同项目。")]),s._v(" "),a("h2",{attrs:{id:"第二章-package-json主要字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二章-package-json主要字段"}},[s._v("#")]),s._v(" 第二章 package.json主要字段")]),s._v(" "),a("p",[s._v("如果只")]),s._v(" "),a("h3",{attrs:{id:"第一节-scripts字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一节-scripts字段"}},[s._v("#")]),s._v(" 第一节 scripts字段")]),s._v(" "),a("p",[s._v("以命令行方式运行程序，通常输入的命令带有各种参数，会造成一条命令很长，操作不便。scripts里以 key：value 的方式定义shell脚本（操作系统可执行的命令）。也就是为一个很长命令行语句，定义成一个命令，使用 "),a("strong",[s._v("npm run")]),s._v(" 调用。")]),s._v(" "),a("div",{staticClass:"language-c line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[s._v("定义script脚本 \n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mytest"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node mytest.js"')]),s._v("    \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("\n调用\nnpm run mytest\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h4",{attrs:{id:"_1-默认设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-默认设置"}},[s._v("#")]),s._v(" 1. 默认设置")]),s._v(" "),a("p",[s._v("npm会默认设置一些固定名称的命令，这些命令具有特殊用途：")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("命令")]),s._v(" "),a("th",[s._v("运行时机")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("test")]),s._v(" "),a("td",[s._v("执行test（测试）时")])]),s._v(" "),a("tr",[a("td",[s._v("publish")]),s._v(" "),a("td",[s._v("发布模块时")])]),s._v(" "),a("tr",[a("td",[s._v("install")]),s._v(" "),a("td",[s._v("模块被安装时")])]),s._v(" "),a("tr",[a("td",[s._v("uninstall")]),s._v(" "),a("td",[s._v("模块被卸载时")])]),s._v(" "),a("tr",[a("td",[s._v("start")]),s._v(" "),a("td",[s._v("开始时"),a("br"),s._v("如果你项目根目录有一个server.js，并且，你又没自定义start，那么npm start就会执行server.js")])]),s._v(" "),a("tr",[a("td",[s._v("stop")]),s._v(" "),a("td",[s._v("停止时")])]),s._v(" "),a("tr",[a("td",[s._v("restart")]),s._v(" "),a("td",[s._v("重启时"),a("br"),s._v("没有自定义restart脚本，会执行：stop，start"),a("br"),s._v("自定义了restart脚本，会执行：prerestart, restart, postrestart")])]),s._v(" "),a("tr",[a("td",[s._v("version")]),s._v(" "),a("td",[s._v("获取版本号时")])])])]),s._v(" "),a("h4",{attrs:{id:"_2-简写"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-简写"}},[s._v("#")]),s._v(" 2. 简写")]),s._v(" "),a("p",[s._v("npm默认设置在运行时可以如下简写：")]),s._v(" "),a("div",{staticClass:"language-c line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[s._v("npm start "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" npm run start\nnpm stop "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" npm run stop\nnpm test "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" npm run test\nnpm restart "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" npm run rerestart \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("案例：编写一个脚本用来运行程序。")]),s._v(" "),a("h4",{attrs:{id:"_3-生命周期与hook前缀"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-生命周期与hook前缀"}},[s._v("#")]),s._v(" 3. 生命周期与hook前缀")]),s._v(" "),a("p",[s._v("可以在执行某些命令前、后做一些操作，比如build前清空目录，build后做一些压缩。")]),s._v(" "),a("p",[s._v("在每个命令前都会执行对应命令的pre+scriptname 脚本")]),s._v(" "),a("p",[s._v("每个命令结束后会执行对应命令的post+scriptname脚本")]),s._v(" "),a("p",[s._v("如果没有定义，则不会执行对应的pre ，post命令")]),s._v(" "),a("div",{staticClass:"language-c line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[s._v("scripts"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prebuild"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is pre build \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is build \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postbuild"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is post build \\""')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nnpm run build\n输出"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" \nthis is pre build\nthis is build\nthis is post build  \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h5",{attrs:{id:"默认命令的生命周期"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#默认命令的生命周期"}},[s._v("#")]),s._v(" 默认命令的生命周期")]),s._v(" "),a("ul",[a("li",[s._v("prepublish：在模块被发布前（其实在安装本地包也会触发）")]),s._v(" "),a("li",[s._v("publish, postpublish：在发布后执行")]),s._v(" "),a("li",[s._v("preinstall：模块被安装前执行")]),s._v(" "),a("li",[s._v("install：模块被安装时执行")]),s._v(" "),a("li",[s._v("postinstall：模块安装后执行")]),s._v(" "),a("li",[s._v("preuninstall, uninstall：模块被卸载前执行")]),s._v(" "),a("li",[s._v("postuninstall：模块卸载后执行")]),s._v(" "),a("li",[s._v("preversion, version：获取版本号前执行")]),s._v(" "),a("li",[s._v("postversion：获取版本号之后执行")]),s._v(" "),a("li",[s._v("pretest, test, posttest：执行test脚本时会执行")]),s._v(" "),a("li",[s._v("prestop, stop, poststop：在脚本结束时执行")]),s._v(" "),a("li",[s._v("prestart, start, poststart：调用start时执行")]),s._v(" "),a("li",[s._v("prerestart, restart, postrestart：在执行restart时会调用")])]),s._v(" "),a("p",[s._v("完整的生命周期脚本")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pretest"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is pre test \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is test \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"posttest"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is post test \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prerestart"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is pre restart \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"restart"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is restart \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postrestart"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is post restart \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n     \n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prestop"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is pre stop \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stop"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is stop \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"poststop"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is post stop \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prestart"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is pre start \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"start"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is start \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"poststart"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is post start \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"preinstall"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is pre install \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"install"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is install \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postinstall"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is post install \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prepublish"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is pre install \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"publish"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is publish \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postpublish"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is post install \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"preuninstall"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is pre uninstall \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"uninstall"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is uninstall \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postuninstall"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is post uninstall \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n     \n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prebuild"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is pre build \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is build \\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postbuild"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\" this is post build \\""')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br")])]),a("h3",{attrs:{id:"第二节-dependencies与devdependencies字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二节-dependencies与devdependencies字段"}},[s._v("#")]),s._v(" 第二节 dependencies与devDependencies字段")]),s._v(" "),a("p",[a("code",[s._v("dependencies")]),s._v(" 字段指定了项目运行所依赖的模块（--save 安装的模块），是生产环境中需要的依赖，即正常运行时所需要的依赖模块")]),s._v(" "),a("p",[a("code",[s._v("devDependencies")]),s._v(" 指定项目开发所需要的模块（--save-dev 安装的模块）。比如：clean-css，我们用它压缩css文件，它们不会被部署到生产环境。")]),s._v(" "),a("h2",{attrs:{id:"第三章-发布-npm-包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三章-发布-npm-包"}},[s._v("#")]),s._v(" 第三章 发布 npm 包")]),s._v(" "),a("h3",{attrs:{id:"第一节-发布前的准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一节-发布前的准备"}},[s._v("#")]),s._v(" 第一节 发布前的准备")]),s._v(" "),a("h4",{attrs:{id:"_1-创建npm账号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-创建npm账号"}},[s._v("#")]),s._v(" 1. 创建npm账号")]),s._v(" "),a("ul",[a("li",[s._v("官网："),a("a",{attrs:{href:"https://links.jianshu.com/go?to=https%3A%2F%2Fwww.npmjs.com%2F",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.npmjs.com/"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("创建账号入口："),a("a",{attrs:{href:"https://links.jianshu.com/go?to=https%3A%2F%2Fwww.npmjs.com%2Fsignup",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.npmjs.com/signup"),a("OutboundLink")],1)])]),s._v(" "),a("h4",{attrs:{id:"_2-入口文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-入口文件"}},[s._v("#")]),s._v(" 2. 入口文件")]),s._v(" "),a("p",[s._v("默认的入口文件是项目根目录下的 "),a("code",[s._v("index.js")]),s._v(" 文件。入口文件就是第三方导入"),a("code",[s._v("require")]),s._v("你的包时执行的代码。内容大体是这样。")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" Customer "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./api/customer"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" Service "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./api/service"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 导入时执行的代码")]),s._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hello world'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 导出的内容")]),s._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("Customer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h4",{attrs:{id:"_3-配置-package-json-文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-配置-package-json-文件"}},[s._v("#")]),s._v(" 3. 配置 "),a("code",[s._v("package.json")]),s._v(" 文件")]),s._v(" "),a("p",[s._v("package.json 文件是使用 "),a("code",[s._v("npm init")]),s._v(" 创建的。如果要发布给其他人使用，这个配置文件里的字段就很重要了。")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("name: 发布的包名，默认是上级文件夹名。不得与现在npm中的包名重复。包名不能有大写字母/空格/下滑线。")])]),s._v(" "),a("li",[a("p",[s._v("version: 项目版本号，")]),s._v(" "),a("blockquote",[a("p",[s._v("对于npm包的版本号有着一系列的规则，模块的版本号采用X.Y.Z的格式：\n1、修复bug，小改动，增加z。\n2、增加新特性，可向后兼容，增加y。\n3、有很大的改动，特别是无法向下兼容,增加x。")])])]),s._v(" "),a("li",[a("p",[s._v("description: 项目描述")])]),s._v(" "),a("li",[a("p",[s._v("author,contributors: 作者和贡献者")])]),s._v(" "),a("li",[a("p",[s._v("main：入口文件，默认是Index.js。")])]),s._v(" "),a("li",[a("p",[s._v("keywords: {Array}关键词，便于用户搜索到我们的项目")])]),s._v(" "),a("li",[a("p",[s._v("homepage: 项目url主页")])]),s._v(" "),a("li",[a("p",[s._v("bin：用来指定各个内部命令对应的可执行文件的位置。(较少用)")])]),s._v(" "),a("li",[a("p",[s._v("bugs: 项目问题反馈的Url或email配置")])]),s._v(" "),a("li",[a("p",[s._v("license: 项目许可证，让使用者知道是如何被允许使用此项目")])]),s._v(" "),a("li",[a("p",[s._v("files: 包含在项目中的文件数组")])]),s._v(" "),a("li",[a("p",[s._v("repository: 代码被托管在何处，这对那些想要参与到这个项目中的人来说很有帮助。")])]),s._v(" "),a("li",[a("p",[s._v("engines：指明了该模块运行的平台，比如 Node 的某个版本或者浏览器。")])]),s._v(" "),a("li",[a("p",[s._v("browser：指定该模板供浏览器使用的版本。")])]),s._v(" "),a("li",[a("p",[s._v("config：用于添加命令行的环境变量。")])]),s._v(" "),a("li",[a("p",[s._v("preferGlobal：表示当用户不将该模块安装为全局模块时（即不用–global参数），要不要显示警告。")])]),s._v(" "),a("li",[a("p",[s._v("peerDependencies ：用来供插件指定其所需要的主工具的版本。")])]),s._v(" "),a("li",[a("p",[s._v("style：指定供浏览器使用时，样式文件所在的位置。")])])]),s._v(" "),a("h3",{attrs:{id:"第二节-登录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二节-登录"}},[s._v("#")]),s._v(" 第二节 登录")]),s._v(" "),a("h4",{attrs:{id:"_1-本机第一次发布包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-本机第一次发布包"}},[s._v("#")]),s._v(" 1. 本机第一次发布包")]),s._v(" "),a("p",[s._v("本机第一次发布包时，需要添加自己的用户信息，以后就不用了。项目根目录下，运行npm adduser命令即可。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" adduser\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("在终端输入npm adduser后，会提示输入账号，密码和邮箱，并提示创建成功。")]),s._v(" "),a("p",[s._v("最后一行显示登录信息，as 后面是用户名。on 后是源地址。国内很多用的是taobao的源 "),a("code",[s._v("http://registry.npm.taobao.org/")]),s._v(" ，在发布时需要切换回官方的 "),a("code",[s._v("https://registry.npmjs.org/")]),s._v("  源。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" config "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" registry https://registry.npmjs.org/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_2-登录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-登录"}},[s._v("#")]),s._v(" 2. 登录")]),s._v(" "),a("p",[s._v("如果已经添加过用户信息，直接登录就可以了。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" login\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"第三节-发布"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三节-发布"}},[s._v("#")]),s._v(" 第三节 发布")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" publish\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("发布完成后，在npm官网中自己的package里，会看到对应的包。")]),s._v(" "),a("h4",{attrs:{id:"常见发布错误"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见发布错误"}},[s._v("#")]),s._v(" 常见发布错误")]),s._v(" "),a("h5",{attrs:{id:"邮箱未验证"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#邮箱未验证"}},[s._v("#")]),s._v(" 邮箱未验证")]),s._v(" "),a("div",{staticClass:"language-swift line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-swift"}},[a("code",[s._v("npm "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ERR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" publish "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Failed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PUT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("403")]),s._v("\nnpm "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ERR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" code "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("E403")]),s._v("\nnpm "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ERR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" you must verify your email before publishing a "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("package")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" https"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("npmjs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("email"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("edit "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" your"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("package\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("这个是注册后没有验证邮箱，登录自己邮箱找到对应的邮件确认就好了。如果验证邮件过期的话登录自己的 npm 主页重新发一个就好了。")]),s._v(" "),a("h5",{attrs:{id:"重名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重名"}},[s._v("#")]),s._v(" 重名")]),s._v(" "),a("div",{staticClass:"language-swift line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-swift"}},[a("code",[s._v("npm "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ERR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" publish "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Failed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PUT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("403")]),s._v("\nnpm "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ERR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" code "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("E403")]),s._v("\nnpm "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ERR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("You")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" not have permission to publish "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"your-package"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Are")]),s._v(" you logged "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" the correct user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" your"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("package\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("你的包和别人的包重名了，npm 里的包不允许重名，所以去 "),a("a",{attrs:{href:"https://links.jianshu.com/go?to=https%3A%2F%2Fwww.npmjs.com%2F",target:"_blank",rel:"noopener noreferrer"}},[s._v("npm"),a("OutboundLink")],1),s._v(" 搜一下，改个没人用的名字就可以了。")]),s._v(" "),a("h5",{attrs:{id:"需要登录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#需要登录"}},[s._v("#")]),s._v(" 需要登录")]),s._v(" "),a("div",{staticClass:"language-swift line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-swift"}},[a("code",[s._v("npm "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ERR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" code "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ENEEDAUTH")]),s._v("\nnpm "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ERR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" need auth auth "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("required")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" publishing\nnpm "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ERR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" need auth "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("You")]),s._v(" need to authorize this machine using `npm adduser`\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("后面已经注明了，输入"),a("code",[s._v("npm adduser")]),s._v("重新登录就可以了，过程和"),a("code",[s._v("npm login")]),s._v("一样，这个问题在你切换了 npm 源之后或登录过期后都有可能发生。")]),s._v(" "),a("h5",{attrs:{id:"只有管理员才有权限发布"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#只有管理员才有权限发布"}},[s._v("#")]),s._v(" 只有管理员才有权限发布")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("npm ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" publish "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Failed")]),s._v(" PUT "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("403")]),s._v("\nnpm ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" code E403\nnpm ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("no_perms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Private")]),s._v(" mode enable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" only admin can publish "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("module")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("no_perms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Private")]),s._v(" mode enable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" only admin can publish "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("module")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" your"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("这个是你的源设置成第三方源的时候才有可能发生，比如设置了淘宝源就"),a("strong",[s._v("可能")]),s._v("会导致该问题。只要把源改回默认的就可以了，如下：")]),s._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[s._v("npm config set registry http"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("registry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("npmjs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h5",{attrs:{id:"包名过于类似"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#包名过于类似"}},[s._v("#")]),s._v(" 包名过于类似")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("npm ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" publish "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Failed")]),s._v(" PUT "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("403")]),s._v("\nnpm ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" code E403\nnpm ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Package")]),s._v(" name too similar "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" existing packages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" renaming your "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@hopgoldy/auto-git'")]),s._v(" and publishing "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'npm publish --access=public'")]),s._v(" instead "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" your"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("如果npm上已经有了不少和你的包名类似的包，就会出现这个问题，在"),a("code",[s._v("package.json")]),s._v("中修改你的包名就可以了")]),s._v(" "),a("h5",{attrs:{id:"无法发布到私有包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#无法发布到私有包"}},[s._v("#")]),s._v(" 无法发布到私有包")]),s._v(" "),a("div",{staticClass:"language-swift line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-swift"}},[a("code",[s._v("npm "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ERR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" publish "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Failed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PUT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("402")]),s._v("\nnpm "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ERR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" code "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("E402")]),s._v("\nnpm "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ERR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("You")]),s._v(" must sign up "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" packages "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("这个当你的包名为"),a("code",[s._v("@your-name/your-package")]),s._v("时才会出现，原因是当包名以"),a("code",[s._v("@your-name")]),s._v("开头时，"),a("code",[s._v("npm publish")]),s._v("会默认发布为私有包，但是 npm 的私有包需要付费，所以需要添加如下参数进行发布:")]),s._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[s._v("npm publish "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("access "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h5",{attrs:{id:"需要提高版本号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#需要提高版本号"}},[s._v("#")]),s._v(" 需要提高版本号")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1、发包 npm publish 失败")]),s._v("\nsh-neverleave:z-tool neverleave$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" publish\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" publish Failed PUT "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("400")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" code E400\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" deprecations must be strings "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" z-tool\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" A complete log of this run can be found in:\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("     /Users/neverleave/.npm/_logs/2018-11-23T10_52_01_742Z-debug.log\nsh-neverleave:z-tool neverleave$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" publish\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2、发包 npm publish 失败")]),s._v("\nsh-neverleave:z-tool neverleave$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" publish\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" publish Failed PUT "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("403")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" code E403\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" You cannot publish over the previously published versions: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v(".3. "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" z-tool\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" A complete log of this run can be found in:\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("     /Users/neverleave/.npm/_logs/2018-11-23T11_24_57_662Z-debug.log\nsh-neverleave:z-tool neverleave$ \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h5",{attrs:{id:"确保登录的用户账号正确"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#确保登录的用户账号正确"}},[s._v("#")]),s._v(" 确保登录的用户账号正确")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("sh-neverleave:npm neverleave$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" publish\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" publish Failed PUT "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("404")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" code E404\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("404")]),s._v(" User not found "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" z-tool\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("404")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("404")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'z-tool'")]),s._v(" is not "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" registry.\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("404")]),s._v(" You should bug the author to publish it "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("or use the name yourself"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("404")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("404")]),s._v(" Note that you can also "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" from a\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("404")]),s._v(" tarball, folder, http url, or "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" url.\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" A complete log of this run can be found in:\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" ERR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("     /Users/neverleave/.npm/_logs/2018-11-23T07_32_28_518Z-debug.log\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h2",{attrs:{id:"附录："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#附录："}},[s._v("#")]),s._v(" 附录：")]),s._v(" "),a("h3",{attrs:{id:"bin子目录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bin子目录"}},[s._v("#")]),s._v(" .bin子目录")]),s._v(" "),a("h4",{attrs:{id:"介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[s._v("#")]),s._v(" 介绍")]),s._v(" "),a("p",[s._v("通过npm安装的部分依赖包，具有windows脚本命令，这些命令会保存到 "),a("code",[s._v("node_modules/.bin")]),s._v(" 目录中，要运行这些命令，必须在 "),a("code",[s._v("package.json")]),s._v(" 文件的 "),a("code",[s._v("scripts")]),s._v(" 字段中定义，通过 "),a("strong",[s._v("npm run")]),s._v("调用。npm run 运行时，会将"),a("code",[s._v("node_modules/.bin")]),s._v(" 子目录加入 "),a("code",[s._v("PATH")]),s._v(" 变量，执行结束后，再将 "),a("code",[s._v("PATH")]),s._v(" 变量恢复原样。")]),s._v(" "),a("blockquote",[a("p",[s._v("windows脚本语言也是一种编程语言，也有自己专门的命令词汇、规范、用法。windows脚本也有不同的语言 如：VBScript、JScript， 他们都内嵌在windows中，不必安装，代码是纯文本，用记事本就能编写。")]),s._v(" "),a("p",[s._v("window脚本文件有两种格式："),a("strong",[s._v("cmd")]),s._v(" 和 "),a("strong",[s._v("bat")]),s._v("，主要区别如下：")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("区别")]),s._v(" "),a("th",[s._v("cmd")]),s._v(" "),a("th",[s._v("bat")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("运行环境")]),s._v(" "),a("td",[s._v("32/64位windows系统（非早期16位dos系统）")]),s._v(" "),a("td",[s._v("无限制")])]),s._v(" "),a("tr",[a("td",[s._v("描述")]),s._v(" "),a("td",[s._v("windowsNT命令脚本")]),s._v(" "),a("td",[s._v("ms-dos批处理文件")])])])])]),s._v(" "),a("h4",{attrs:{id:"案例演示"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#案例演示"}},[s._v("#")]),s._v(" 案例演示")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("创建脚本文件")]),s._v(" "),a("p",[s._v("在 "),a("code",[s._v("node_modules/.bin")]),s._v(" 目录下创建 "),a("code",[s._v("mytest.cmd")]),s._v(" 文件，内容如下：")])])]),s._v(" "),a("div",{staticClass:"language-c line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[s._v("echo hello world\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("在package.json文件的scripts字段中增加命令：")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mytest"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("运行脚本")])]),s._v(" "),a("div",{staticClass:"language-c line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[s._v("npm run hello\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);